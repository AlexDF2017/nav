<div class="netmapWidget">
    <div class="header{{#unless isWidgetCollapsible}} no_collapse{{/unless}}">
        <div class="header"><div class="title no-icon">Link info</div></div>
    </div>
    <div class="body">
        <p>Linknet#: {{link.edges.length}}</p>
        {{#if l3 }}
            {{! Layer 3 template here.  }}
            {{#each link.edges}}
                {{! this.id is an netmap.models.Vlan FYI }}
                <div class="uplink_prefix">
                    <h4>{{ this.id.net_ident }}</h4>
                    <span class="prefix_description">{{ this.id.description }}</span>

                        {{#each this.edges}}
                            <div>
                                <div>
                                    <div class="prefix">{{this.prefix}}</div>
                                    <div>
                                        <div class="toggleUplink">+
                                        <div class="linkSource">
                                            <div class="uplink_netbox">{{this.source.netbox.sysname}}</div>
                                            <div>{{#unless this.source.netbox.interface}}{{this.source.netbox.interface}}{{else}}N/A{{/unless}}</div>
                                            <div>{{this.source.gw_ip}}</div>
                                            <div>{{this.source.virtual}}</div>
                                        </div>
                                        <div class="linkSource">
                                            <div class="uplink_netbox">{{this.target.netbox.sysname}}</div>
                                            <div>{{#unless this.target.netbox.interface}}{{this.target.netbox.interface}}{{else}}N/A{{/unless}}</div>
                                            <div>{{this.target.gw_ip}}</div>
                                            <div>{{this.target.virtual}}</div>
                                        </div>
                                            </div>
                                    </div>
                                </div>
                            </div>
                        {{/each}}
                </div>
            {{/each}}
        {{else}}
            {{! Layer 2 template here.  }}
        {{/if}}

        {{#if link.data.uplink.vlan}}
        <div class="uplink_prefix">

            <h4>{{link.data.uplink.vlan.net_ident}}</h4>
            <span class="prefix_description">{{link.data.uplink.vlan.description}}</span>
            <span class="description">Prefix members</span>
            <ul class="uplink_prefixes">
                {{#each link.data.uplink.prefixes}}
                    <li class="prefix_net_address">{{this}}</li>
                {{/each}}
            </ul>

        </div>
        {{/if}}
        <div>
            <div class="uplink_this uplink">
                {{#if link.data.uplink.thiss.netbox_link}}
                    <span class="uplink_netbox"><a class="uplink_netbox_link" href="{{link.data.uplink.thiss.netbox_link}}">{{link.data.uplink.thiss.netbox}}</a></span> <span class="uplink_interface">[<a class="uplink_interface_link" href="{{link.data.uplink.thiss.interface_link}}">{{link.data.uplink.thiss.interface}}</a>]</span>
                    {{#if link.data.uplink.vlan}}
                        <span class="uplink_gw_ip">{{link.data.uplink.thiss.gw_ip}}</span>
                        <span class="uplink_virtual">virtual: {{link.data.uplink.thiss.virtual}}</span>
                    {{/if}}
                {{else}}
                    <span class="uplink_netbox">{{link.data.uplink.thiss.netbox}}</span> <span class="uplink_interface">[{{link.data.uplink.thiss.interface}}]</span>
                    {{#if link.data.uplink.vlan}}
                        <span class="uplink_gw_ip">{{link.data.uplink.thiss.gw_ip}}</span>
                        <span class="uplink_virtual">virtual: {{link.data.uplink.thiss.virtual}}</span>
                    {{/if}}
                {{/if}}
                <span class="trafficOctets">Traffic in: {{inOctets}}</span>
                {{#if link.data.traffic.inOctetsPercentBySpeed}}
                    <span class="trafficPercentByLinkSpeed">({{link.data.traffic.inOctetsPercentBySpeed}}%)</span>
                {{/if}}
            </div>

            <div class="uplink_other uplink">
                {{#if link.data.uplink.other.netbox_link}}
                    <span class="uplink_netbox"><a class="uplink_netbox_link" href="{{link.data.uplink.other.netbox_link}}">{{link.data.uplink.other.netbox}}</a></span> <span class="uplink_interface">[<a class="uplink_interface_link" href="{{link.data.uplink.other.interface_link}}">{{link.data.uplink.other.interface}}</a>]</span>
                    {{#if link.data.uplink.vlan}}
                        <span class="uplink_gw_ip">{{link.data.uplink.other.gw_ip}}</span>
                        <span class="uplink_virtual">virtual: {{link.data.uplink.other.virtual}}</span>
                    {{/if}}
                {{else}}
                    <span class="uplink_netbox">{{link.data.uplink.other.netbox}}</span> <span class="uplink_interface">[{{link.data.uplink.other.interface}}]</span>
                    {{#if link.data.uplink.vlan}}
                        <span class="uplink_gw_ip">{{link.data.uplink.other.gw_ip}}</span>
                        <span class="uplink_virtual">virtual: {{link.data.uplink.other.virtual}}</span>
                    {{/if}}
                {{/if}}
                <span class="trafficOctets">Traffic in: {{outOctets}}</span>
                {{#if link.data.traffic.outOctetsPercentBySpeed}}
                    <span class="trafficPercentByLinkSpeed">({{link.data.traffic.outOctetsPercentBySpeed}}%)</span>
                {{/if}}
            </div>
        </div>
    </div>
</div>