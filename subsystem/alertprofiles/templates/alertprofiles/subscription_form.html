{% extends "alertprofiles/base.html" %}

{% block tabcontent %}

{% block subscriptions %}
{% if subscriptions %}
<form action="{% url alertprofiles-profile-timeperiod-subscription-remove %}" method="post">
    <table class="listtable">
        <caption>
            Subscriptions<br />
            <span class="subtitle">
               For profile {{ time_period.profile.name }}<br />
               Time period starting at {{ time_period.start }} for
               {{ time_period.get_valid_during_display }}
            </span>
        </caption>

        <thead>
            <tr>
                <th></th>
                <th>Watched filter group</th>
                <th>Alert address</th>
                <th>Dispatch</th>
                <th>Ignore closed alerts</th>
                <th></th>
            </tr>
        </thead>

        <tbody>
        {% for s in subscriptions %}
            <tr>
                <td><input type="checkbox" name="subscription"
                id="id_subscription_{{ s.id }}" value="{{ s.id }}" /></td>
                <td>{{ s.filter_group.name }}</td>
                <td>{{ s.alert_address.address }}</td>
                <td>{{ s.get_type_display|capfirst }}</td>
                <td>{{ s.ignore_closed_alerts|yesno:"Yes,No" }}</td>
                <td><a href="{% url alertprofiles-profile-timeperiod-subscription s.id %}">
                    Edit</a></td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <p>
        <input type="hidden" name="id" value="{{ time_period.id }}" />
        <button type="submit">Delete selected</button>
    </p>
</form>
{% endif %}
{% endblock subscriptions %}

{% block subscription_form %}
<form action="{% url alertprofiles-profile-timeperiod-subscription-add %}" method="post">
    <div class="infobox">
        <h4>{{ editing|yesno:"Edit,Add new" }} subscription</h4>
        {{ form.non_field_errors }}
        Watch {{ form.filter_group }},
        send alerts to {{ form.alert_address }} {{ form.type }}
        <p>
            <label>
                {{ form.ignore_closed_alerts }} {{ form.ignore_closed_alerts.label }}
            </label>
        </p>
        <p>
            {{ form.time_period }}
            {{ form.id }}
            <button type="submit">{{ editing|yesno:"Save,Add" }}</button>
        </p>
    </div>
</form>
{% endblock subscription_form %}

{% endblock tabcontent %}
