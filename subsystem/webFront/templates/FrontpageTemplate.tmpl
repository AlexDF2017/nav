
#extends MainTemplate

#attr boxesdown = False

#attr numberOfBoxesShown = 10
#attr numberOfMessagesShown = 5

#from nav.web import shouldShow

#block content
   <table border="0" cellspacing="0" cellpadding="0">
     <tr>
       <td valign="top" width="190">
	$navlinksbox <br>
	$externallinksbox <br>
	$contactinformationbox <br>
       </td>
       <td><img src='$imagefolder/blank.gif' width="10"></td>
       <td valign="top">
	$welcome
        <table border="0" cellspacing="0" cellpadding="0"><tr><td>
	$emotd() </td></tr><tr><td>
	$status </td></tr></table>
       </td>
     </tr>
   </table>
#end block

#def navlinksbox
  $sideboxstart('NAV-links')
  $navlinks
  $sideboxend()     
#end def

#def navlinks
#end def

#def externallinksbox
  $sideboxstart('External links')
  $externallinks
  $sideboxend()
#end def

#def externallinks
#end def

#def contactinformationbox
  $sideboxstart('Contact information')
  $contactinformation
  $sideboxend()
#end def

#def contactinformation
#end def

#def welcome
#end def

#def status
  <br>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<!------------------------- STATUS TITLE  ---->
    <tr class="title">
      <td class="title" align="center" colspan="5" style="background-image:url('$imagefolder/status/statuslogo+fill.gif'); background-repeat: no-repeat;">  
        <table class="navigation" cellspacing="0" cellpadding="0" border="0">
          <tr class="navigation">
            <td class="current">
              <div class="title"><a href="/status/"><font color="black">Status Now</font></a></div>
              $numboxesdown boxes down, $numboxesshadow in shadow
            </td>
          </tr>
        </table>
      </td>
      <td align=right style="background-image:url('$imagefolder/arpcam/fill.gif');"><img src="$imagefolder/ragen/top-end.gif"></td>
    </tr>
<!------------------------- STATUS HEADER ---->
    <tr class="header">
      <td bgcolor="white" style="background-image:url('$imagefolder/ragen/navbar-start.gif'); background-repeat: no-repeat; width: 14px" rowspan="11">
        <img src="$imagefolder/blank.gif" width="14" height="1" alt="" />
      </td>
      <td class="header" valign="top" bgcolor="white" nowrap >
          Sysname &nbsp;
      </td>
      <td class="header" valign="top" bgcolor="white" nowrap >
          IP &nbsp;
      </td>
      <td class="header" valign="top" bgcolor="white" nowrap >
          Downtime &nbsp;
      </td>
      <td class="header" valign="top" bgcolor="white" nowrap >
          Down since &nbsp;
      </td>
      <td bgcolor="white" style="background-image:url('$imagefolder/ragen/navbar-end.gif'); background-position: top right; background-repeat: no-repeat; width: 14px;" rowspan="11">
        <img src="$imagefolder/blank.gif" width="14" height="1" alt="" />
      </td>
    </tr>

#set $numberdown = 0
#set $row = "oddrow"
#for $box in $boxesdown
#if not $box[4]
  #if $numberdown < $numberOfBoxesShown
    <tr class="$row">
    #if shouldShow("/browse/$box[1]", $user)
      <td><a href="/browse/$box[1]">$box[1]</a>&nbsp;&nbsp;</td>
    #else
      <td>$box[1]&nbsp;&nbsp;</td>
    #end if
      <td>$box[2]&nbsp;&nbsp;</td>
      <td align="right"><a title="$box[0]"><font color="black">$box[5]</font></a>&nbsp;&nbsp;</td>
      #set $since = $box[3].strftime('%d/%m/%Y %H:%M')
      <td>$since</td>
    </tr>
    #if $row == "evenrow"
      #set $row = "oddrow"
    #else
      #set $row = "evenrow"
    #end if
  #end if
  #set $numberdown = $numberdown + 1
#end if
#end for

#if len($boxesdown) > $numberOfBoxesShown
  #set $linktext = "(more)"
#else
  #set $linktext = "(to status page)"
#end if
<tr><td colspan="6" align="center"><font size="-2"><a href="/status/">$linktext</td></tr>

</table>

#end def

#def emotd

#if $messages:
<table style="font-size:13px; border: 1px solid black;" cellspacing="0">
  <TR><TD COLSPAN=2 STYLE="BACKGROUND: URL('/images/emotd/top-r.gif') REPEAT-X;">
  <div style="position: relative; margin-top: -12px;"><img src="/images/emotd/top-l.gif"></div>
  <div style="position: relative; margin: -25px 0px 0px 50px; padding-bottom: 8px;font-size:15px;">$title</div>
  </TD></TR>
#set $farge = "white";
  #for $message in $messages
   <tr style="background: $farge;">
      <td style="padding: 0px 10px;"><a href="/messages/view/$message.id">$message.title</a></td>
#if $message.units
      <td style="padding: 0px 10px;" align="right"><a href="/messages/add/$message.id"><img src="/images/wrench.gif" border="0">$message.units</a></td>
#else
      <td style="padding: 0px 10px;">&nbsp;</td>      
#end if

#if $message.new
          	Edited: $message.last_changed by $message.author<br />
	        Description: $message.description<br />
		Units on maintenance: $message.units<br />
		Is this a new message: $message.new
#end if

#if $farge == "white":
#set $farge = "#eeeeee"
#else:
#set $farge = "white"
#end if
   </tr>
  #end for
</table>
#else:
No $title found.<br>
#end if

##   <br>
##   #from nav.web.EmotdSelect import getAllActive
##   #set $emotds = getAllActive()
##   #set $antemotds = len($emotds)
##   <table width="100%" cellspacing="0" cellpadding="0" border="0">

##     <tr class="title">
##       <td class="title" align="center" colspan="3" style="background-image:url('$imagefolder/emotd/emotdlogo+fill.gif'); background-repeat: no-repeat;">  
##         <table class="navigation" cellspacing="0" cellpadding="0" border="0">
##           <tr class="navigation">
##             <td class="current">
## #if $antemotds == 0
##               <div class="title"><a href="/emotd/"><font color="black">Messages of the Day</font></a></div>
##                 No active messages
## #else if $antemotds == 1
##               <div class="title"><a href="/emotd/"><font color="black">Message of the Day</font></a></div>
##                 One active message
## #else
##               <div class="title"><a href="/emotd/"><font color="black">Messages of the Day</font></a></div>
##                 $antemotds active messages
## #end if
##             </td>
##           </tr>
##         </table>
##       </td>
##       <td align=right style="background-image:url('$imagefolder/arpcam/fill.gif');"><img src="$imagefolder/ragen/top-end.gif"></td>
##     </tr>
##   </table>
##   <table width="100%" cellspacing="0" cellpadding="0" border="0">

##   #set $antall = 0
##   #for $emotd in $emotds
##      #if $antall < $numberOfMessagesShown
##      <tr>
##        <td style="border-top: 1px solid white; border-left: 1px solid white; background-color: #eee;">
##          <a href="/emotd/view?id=$emotd.emotdid">$emotd.title</a>
##        </td>
##        <td colspan="2" align="right" style="border-top: 1px solid white; border-right: 1px solid white; background-color: #eee; font-size: 11px">
## 	  #set $last = $emotd.last_changed
##           #set $date = $last[-2:] + "/" + $last[5:7] + "/" + $last[0:4]
##           $date
##        </td>
##      </tr>
##      <tr>
##        <td colspan="3" style="border-bottom: 1px solid white; border-left: 1px solid white; border-right: 1px solid white;">
##          $emotd.description
##        </td>
##      </tr>
##      #end if
##      #set $antall = $antall + 1
##   #end for
##   #if len($emotds) > $numberOfMessagesShown
##     #set $linktext = "(more)"
##   #else
##     #set $linktext = "(to message of the day page)"
##   #end if
##      <tr><td colspan="6" align="center"><font size="-2"><a href="/emotd/">$linktext</td></tr>
##    </table>
#end def
<a href="/messages/" style="text-align:center">(messages of the day)</a>

#def sideboxstart($title)
  <table border="0" cellspacing="0" cellpadding="3" width="100%" class="sidebox">
    <tr>
      <td class="sideboxtitle">
        $title
      </td>
    </tr>
    <tr>
      <td class="sideboxlinks">
#end def

#def sideboxend
      </td>
    </tr>
  </table>
#end def

#block additionalCSS
      TD { 
        font-family: verdana, arial, helvetica, sans-serif;
	font-size: 13;
      }

      TD.smallfont {
        font-size: 11;
      }

      td.sideboxlinks {
      font-size: 11;
      border: 1px solid #ccc;
      }

      td.sideboxtitle {
      font-size: 13;
      border: 1px solid #000;
      text-align: center;
      background-image:url('/images/form/fill-active.gif');
      background-color:#ccf;
      }

$default_table_CSS
#end block
