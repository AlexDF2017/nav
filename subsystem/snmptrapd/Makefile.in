SHELL = @SHELL@
INSTALL = @INSTALL@
CHEETAH = @CHEETAH@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
libdir = @libdir@
sysconfdir = @sysconfdir@
initdir = @initdir@
pythonlibdir = @pythonlibdir@

libfiles = nav/snmptrapd/__init__.py nav/snmptrapd/handlers/airespace.py nav/snmptrapd/handlers/linkupdown.py nav/snmptrapd/handlers/__init__.py nav/snmptrapd/handlers/handlertemplate.py
binfiles = snmptrapd.py
conffiles = snmptrapd.conf
initfiles = snmptrapd

.PHONY: all install install-lib install-bin clean distclean

all:

install: install-bin install-lib install-conf

install-bin: $(initfiles)
	for file in $(binfiles); do \
	  $(INSTALL) -v -D -m 755 $$file $(DESTDIR)$(bindir)/$$file || exit 1; \
	done
	for file in $(initfiles); do \
	  $(INSTALL) -v -D -m 755 $$file $(DESTDIR)$(initdir)/$$file || exit 1; \
	done

install-conf:
	for file in $(conffiles); do \
	  target=$(DESTDIR)$(sysconfdir)/$$file; \
	  if [ -f "$$target" ]; then \
            echo Skipping installation of config file $$file; \
          else \
	    $(INSTALL) -v -D -m 644 $$file $$target || exit 1; \
	  fi; \
	done

install-lib:
	for file in $(libfiles); do \
	  $(INSTALL) -v -D -m 644 $$file $(DESTDIR)$(pythonlibdir)/$$file || exit 1; \
	done

clean:
	rm -f *~

distclean: clean
	rm -f Makefile
