SHELL = @SHELL@
INSTALL = @INSTALL@

prefix = @prefix@
exec_prefix = @exec_prefix@
tooldir = @tooldir@
crondir = @crondir@

tool = messages.tool
subdirs = templates src lib bin

.PHONY: all install clean distclean

all:
	for dir in $(subdirs); do \
	  $(MAKE) -C $$dir $@ || exit 1; \
	done

install:
	for dir in $(subdirs); do \
	  $(MAKE) -C $$dir $@ || exit 1; \
	done
	$(INSTALL) -D -v -m 644 $(tool) $(DESTDIR)$(tooldir)/$(tool)
	$(INSTALL) -D -v -m 644 maintengine $(DESTDIR)$(crondir)/maintengine

clean:
	for dir in $(subdirs); do \
	$(MAKE) -C $$dir $@ || exit 1; \
	done
	rm -f *~

distclean: clean
	for dir in $(subdirs); do \
	$(MAKE) -C $$dir $@ || exit 1; \
	done
	rm -f Makefile
