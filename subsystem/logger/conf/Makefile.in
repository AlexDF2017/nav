SHELL = @SHELL@
INSTALL = @INSTALL@
CHEETAH = @CHEETAH@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
libdir = @libdir@
sysconfdir = @sysconfdir@

pythonlibdir = @pythonlibdir@
templatedir = ${pythonlibdir}/nav/web/templates
webroot = @webroot@
localstatedir = @localstatedir@

top_srcdir = @top_srcdir@

conffiles = logger.conf

export
.PHONY: all install install-conf clean distclean

all: logger.conf

logger.conf: logger.conf.source
	$(top_srcdir)/tools/expand.pl logger.conf.source > logger.conf

install: all install-conf

install-conf:
	@for file in $(conffiles); do                          \
	  target=$(DESTDIR)$(sysconfdir)/$$file;               \
	  if [ -f "$$target" ]; then                           \
	    echo Skipping installation of config file $$file;  \
	  else                                                 \
	    $(INSTALL) -v -D -m 644 $$file $$target || exit 1; \
	  fi;                                                  \
	done

clean:
	rm -f *~
	rm -f logger.conf

distclean: clean
	rm -f Makefile
