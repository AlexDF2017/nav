## -*- coding: ISO8859-1 -*-
## $Id$
##
## Copyright 2006 UNINETT AS
##
## This file is part of Network Administration Visualized (NAV)
##
## NAV is free software; you can redistribute it and/or modify
## it under the terms of the GNU General Public License as published by
## the Free Software Foundation; either version 2 of the License, or
## (at your option) any later version.
##
## NAV is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
## GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with NAV; if not, write to the Free Software
## Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
##
##
## Author: Stein Magnus Jodal <stein.magnus@jodal.no>
##

#extends MainTemplate
#import datetime

#attr $title = 'My SMS'
#attr $path = [("Home", "/"), ("AlertProfiles", "/alertprofiles/"), ("My SMS",
"")]

#def add_message($message, $row)
	<tr class="$row">
		<td>$message['time'].strftime('%Y-%m-%d %H:%M:%S')</td>
	#if $message['timesent']:
		<td>$message['timesent'].strftime('%Y-%m-%d %H:%M:%S')</td>
	#else
		<td></td>
	#end if
		<td>$message['phone']</td>
		<td>$message['msg']</td>
		<td>$message['severity']</td>
	#if $message['sent'] == 'Y':
		<td style="color: green">Sent</td>
	#else if $message['sent'] == 'N':
		<td style="color: red">Not sent</td>
	#else if $message['sent'] == 'I':
		<td style="color: gray">Ignored</td>
	#end if
	</tr>
#end def

#block content

<h2>My SMS</h2>

<form name="searchform" action="" method="get">
	Show messages from the last
	<input type="text" name="days" size="3" value="$days" />
	days for the phone numbers: $phones.
	<input type="submit" value="Search" />
</form>


<table id="results" width="100%" cellspacing="0" cellpadding="0" border="0">

#set $rows = len($messages)
	<caption>
		<div class="cornerkludge"></div>
		<div class="title">Message list</div>
		<div class="subtitle">$rows messages</div>
	</caption>

#set $rows = len($messages) + 2
	<tr class="header">
		<td class="leftkludge" rowspan="$rows"></td>
		<th>Time</th>
		<th>Time Sent</th>
		<th>Phone No.</th>
		<th>Message</th>
		<th>Severity</th>
		<th>Status</th>
		<td class="rightkludge" rowspan="$rows"></td>
	</tr>

#set $row = "oddrow"
#for $message in $messages
$add_message($message, $row)
	#if $row == "evenrow"
		#set $row = "oddrow"
	#else
		#set $row = "evenrow"
	#end if
#end for

</table>

#end block content

#block additionalCSS
$default_table_CSS
#end block additionalCSS
