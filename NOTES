===========================
 Release notes for NAV 3.6
===========================
Please report bugs at https://bugs.launchpad.net/nav

If you are upgrading from versions of NAV older than 3.5, please refer
to the release notes of the in-between versions before reading any
further.

WARNING: This is an unstable *BETA* version of NAV 3.6, and should in no way be
used on a production system.  The standard GPL disclaimers apply.


Known problems
==============
NAV has a dependency on both PySNMP v2 and PySNMP-SE.  These two versions
cannot normally be installed simultaneously, but Debian has provisions for
this, allowing for switching between the versions by setting a specific
environment variable.  NAV 3.6 was developed on Debian and used this
convention, but since it is not normally available on other platforms, the
snmptrapd will not work on any other platform than Debian yet.  We are working
on a PySNMP version-neutral fix for snmptrapd (for SeedDB and Arnold this was
fixed in the 3.6.0b2 release).

To see the overview of scheduled features and reported bugs on the 3.6 series
of NAV, please go to https://launchpad.net/nav/3.6 .


Upgrading from NAV 3.5
======================

SNMP collector
--------------
NAV 3.6 replaces the getDeviceData SNMP collector, written in Java, with
ipdevpoll, written in Python.

NAV still uses cricket for collecting traffic and load statistics, and
getBoksMacs for CAM table and CDP cache collection.  getBoksMacs will likely be
incorporated into ipdevpoll in future versions.


Database changes
----------------
There are many database changes since NAV 3.5.  Before installing the new NAV
version, stop NAV, install, then upgrade the database schema using the
procedure documented in doc/sql/README.

Cricket and temperatures
------------------------
NAV 3.6 changes the way in which temperature values are collected.  Temperature
statistics were previously only supported for Cisco devices.  However, this
support was terribly broken, and you may already be experiencing problems with
this if you have upgraded to recent IOS versions.

Due to these changes, you will not be able to keep historic temperature data
for your Cisco devices (if you have any such data), but you need to follow a
specific procedure before attempting to start NAV 3.6:

1. Make sure Cricket is not running (`nav status cricket` and check ps output)

2. Make sure to backup all your RRD files and your cricket-config directory.

3. Run `migrate_cricket.py`. This will:

   - Delete cricket-related entries from NAV's RRD registry (don't worry, it
     will be filled again when the new makecricketconfig runs).

   - Remove any temperature-related data sources from your RRD files. This is
     done to remove the previously mentioned brokenness.

4. Remove old configuration files from the cricket-config directory. This is
   only necessary for:

   - Defaults
   - routers/*
   - router-interfaces/*
   - switches/*
   - switch-ports/*

5. Copy the new default cricket-config directory treec files to the
   cricket-config directory - these were installed in the doc directory under
   cricket/cricket-config (or can be found in the source under
   subsystem/statTools/cricket/cricket-config).

6. Make sure that the `datapath` in the top level `Defaults` file is correct
   and pointing to the directory where the RRD files are stored.

7. Run `extract_cricket_oids.py`.  This extracts OIDs from the cricket
   configuration tree and inserts them into NAV's OID registry.

You can now run `mcc.py` to create the new Cricket configuration from your
database contents.


Dependency changes
------------------
The following dependencies are new to NAV 3.6:

* Twisted >= 8.1
* twisted-snmp >= 0.3
* pysnmp-se >= 3.5

The following are no longer dependencies in NAV 3.6:

* Perl
* The Python module forgetSQL
* psycopg1 (but please keep psycopg2!)

A dependency to the python module pyrad was previously undocumented.
This module is required if you wish to monitor radius servers using
NAV's service monitor.  The module can be found at
http://www.wiggy.net/code/pyrad/ .


Files to remove
---------------
The following files and directories should be removed from your installation
after upgrading to NAV 3.6 from a source code distribution (installation prefix
has been stripped from these file names).  If you installed and upgraded NAV
using a packaging system, you should be able to safely ignore this section.

  apache/tools/devicemanagement.tool
  apache/webapps/
  apache/webroot/about/
  apache/webroot/devicemanagement/
  apache/webroot/index.py
  apache/webroot/ipinfo/
  apache/webroot/l2trace/l2trace.py
  apache/webroot/machinetracker/machinetracker.py
  apache/webroot/preferences/
  apache/webroot/rrd/
  apache/webroot/seeddb/*.py
  apache/webroot/toolbox/
  bin/cleanrrds.pl
  bin/getDeviceData.sh
  bin/makecricketconfig.pl
  doc/cricket/cricket-config/*/.nav
  doc/cricket/cricket-config/.nav
  etc/getDeviceData.conf
  etc/init.d/getDeviceData
  etc/machinetracker.conf
  etc/vPServer.conf
  etc/webfront/ipinfo.conf
  lib/java/getDeviceData/
  lib/python/nav/auth.py
  lib/python/nav/db/forgotten/
  lib/python/nav/db/manage.py
  lib/python/nav/db/navprofiles.py
  lib/python/nav/dump.py
  lib/python/nav/web/SearchBox.py
  lib/python/nav/web/TreeSelect.py
  lib/python/nav/web/devicemanagement/
  lib/python/nav/web/ipinfo/
  lib/python/nav/web/templates/AlertProfilesTemplate.py
  lib/python/nav/web/templates/FrontpageTemplate.py
  lib/python/nav/web/templates/IPInfo.py
  lib/python/nav/web/templates/IpDevInfoTemplate.py
  lib/python/nav/web/templates/MachineTrackerTemplate.py
  lib/python/nav/web/templates/NetworkExplorerTemplate.py
  lib/python/nav/web/templates/RrdViewerTemplate.py
  lib/python/nav/web/templates/SearchBoxTemplate.py
  lib/python/nav/web/templates/ToolboxTemplate.py
  lib/python/nav/web/templates/TreeSelectTemplate.py
  lib/python/nav/web/templates/UserAdmin.py
  lib/python/nav/web/templates/deviceManagementTemplate.py
  lib/python/nav/web/toolbox.py
  lib/templates/alertprofiles/debug.html
  lib/templates/ipdevinfo/debug.html
  lib/templates/networkexplorer/debug.html

