=============================
 Release notes for NAV 3.2.0
=============================
Please report bugs at http://sourceforge.net/projects/nav

Upgrading from NAV 3.1.1
========================

New messages and maintenance subsystems
---------------------------------------
NAV 3.2 introduces new messages and maintenance systems, rewritten from
scratch.  These also utilize new database tables.  There is no migration
strategy for these systems, which means that any maintenance schedules and
messages you have in your old NAV installation will be lost during the database
upgrade.


Update Cricket configuration
----------------------------
NAV 3.2 finally configures Cricket to exclusively use 64-bit traffic counters
for SNMPv2-enabled devices.  This also means you must update your Cricket
configuration tree with new Defaults- and .nav-files from NAV.

NAV's initial Cricket configuration tree is found in the source code under the
subsystem/statTools/cricket/cricket-config/ subdirectory.  Copy this
recursively to your active cricket-config directory (and make sure to also copy
the hidden .nav files as well).  If your cricket-config directory is
/usr/local/cricket/cricket-config/ , you can do it like this:

  cp -rv subsystem/statTools/cricket/cricket-config \
         /usr/local/cricket/

Also, you can update your Cricket installation's 'subtree-sets' file, which is
contained in the same directory as cricket-conf.pl.  Remove the 'giga' subtree.
Nothing should break if you forget to, however.


Cricket data migration
----------------------
The switch to 64-bit traffic counters also means that the "giga" configuration
subtrees and data directories are now obsolete, and the cron process that ran
collection for the giga subtree once a minute has been removed.  All Cricket
data collection is now done in 5 minute intervals.

After the upgrade, before you start NAV/Cricket again, you will need to move
your existing RRD-files in the giga directories to the corresponding "normal"
directories, if you want to keep historical statistical data for your gigabit
interfaces.

Go to your cricket-data directory, there you should typically find the
following subdirectories:

  router-interfaces                  switches
  router-interfaces-snmpv1-and-giga  switch-ports
  routers                            switch-ports-snmpv1-and-giga

Move the data files from the giga directories into the corresponding non-giga
directories, like so:

  mv router-interfaces-snmpv1-and-giga/* router-interfaces
  mv switch-ports-snmpv1-and-giga/* switch-ports

Be aware that if you are running an older version of NAV, your giga directories
might instead be named 'giga-switch-ports' and 'giga-router-interfaces'. 

When you've done this, you should run makecricketconfig.pl and cleanrrds.pl as
the navcron user, to create a new Cricket configuration tree and clean up NAV's
RRD file database:

  # su navcron
  $ makecricketconfig.pl
  $ cleanrrds.pl -r


You may notice discontinuities in your gigabit traffic graphs at the time of
the upgrade, due to the switch from 32-bit to 64-bit counters.
