{% extends 'threshold/base.html' %}

{% block content %}

<div id="messagesDiv">
</div>

{% regroup netboxes|dictsort:"sysname" by sysname as netbox_list %}

{% for netbox in netbox_list %}
<div class="netboxcontainer">
    <h3>
        <a href="{% url ipdevinfo-details-by-name netbox.grouper %}">{{ netbox.grouper }}</a>&nbsp;
            <img class="toggler" src="{{ STATIC_URL }}images/threshold/plus-button.png" alt="+"/>
            <img class="toggler" src="{{ STATIC_URL }}images/threshold/minus-button.png" alt="-" style="display: none;"/>
    </h3>
<table class="vertitable" style="display: none;">
    <thead>
    <tr>
        <th>Interface name</th>
        <th>Interface alias</th>
        <th>Description</th>
        <th>Operator</th>
        <th>Threshold</th>
        <th>Units</th>
        <th>Max</th>
        <th>Thresholdstate</th>
        <th>&nbsp;</th>
    </tr>
    </thead>
    <tbody>
    {% for item in netbox.list %}
        {% for threshold in item.sources %}
        <tr class="{{threshold.id}}">
                {% if threshold.rrd_file.interface %}
                    {% if threshold.rrd_file.interface.ifname %}
                        <td>
                        <a href="{% url ipdevinfo-interface-details threshold.rrd_file.interface.netbox.sysname threshold.rrd_file.interface.id %}">
                        {{ threshold.rrd_file.interface.ifname }}</a>
                        </td>
                    {% else %}
                        <td>&nbsp;</td>
                    {% endif %}
                    {% if threshold.rrd_file.interface.ifalias %}
                        <td>
                        <a href="{% url ipdevinfo-interface-details threshold.rrd_file.interface.netbox.sysname threshold.rrd_file.interface.id %}">
                            {{ threshold.rrd_file.interface.ifalias }}</a>
                        </td>
                    {% else %}
                        <td>&nbsp;</td>
                    {% endif %}
                {% else %}
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                {% endif %}
                <td>
                    <span title="{{ threshold.extra_descr }}">{{ threshold.description }}</span>
                </td>
                <td>
                    <select class="operator">
                    {% if threshold.delimiter %}
                        {% ifequal threshold.delimiter ">" %}
                        <option value=">" selected="selected">Greater than</option>
                        <option value="<">Less than</option>
                        {% else %}
                        <option value=">">Greater than</option>
                        <option value="<" selected="selected">Less than</option>
                        {% endifequal %}
                    {% else %}
                    <option value=">">Greater than</option>
                    <option value="<">Less than</option>
                    {% endif %}
                    </select>
                </td>
                <td>
                    <input type="text" class="threshold"
                        value="{% if threshold.threshold %}{{ threshold.get_threshold_value }}{% endif %}">
                </td>
                <td>
                    {% if threshold.units %}
                        {% if threshold.max %}
                            <select class="unit">
                            {% if threshold.is_percent %}
                                <option value="{{threshold.units}}">{{threshold.units}}</option>
                                <option value="%" selected="selected">&#37;</option>
                            {% else %}
                                <option value="{{threshold.units}}" selected="selected">{{threshold.units}}</option>
                                <option value="%">&#37;</option>
                            {% endif %}
                            </select>
                        {% else %}
                            {{threshold.units}}
                        {% endif %}
                    {% else %}
                        &nbsp;
                    {% endif %}
                </td>
                <td class="maxvalue">
                    {% if threshold.max %}
                        {{ threshold.max }}
                        {% if threshold.units %}
                            &nbsp;{{ threshold.units }}
                        {% endif %}
                    {% endif %}
                </td>
                <td>
                    {% if threshold.threshold_state %} {{ threshold.threshold_state }} {% endif %}
                </td>
                <td>
                    <input class="button" type="button" value="Update" />
                </td>
        <tr>
        {% endfor %}
    {% endfor %}
</tbody>
</table>
</div>
{% endfor %}
{% endblock %}

