{% load string_manipulation %}
<div class="report-table-wrapper">

  <table class="listtable full-width">

    <caption>

      {# Pagination list #}
      <ul class="pagination right">

        <li>
          <a href="?page_number=1&{{ query_string }}">First</a>
        </li>

        {% if page.has_previous %}
          <li class="arrow">
            <a href="?page_number={{ page.previous_page_number }}&{{ query_string }}">&laquo;</a>
          </li>
          <li>
            <a href="?page_number={{ page.previous_page_number }}&{{ query_string }}">{{ page.previous_page_number }}</a>
          </li>
        {% else %}
          <li class="arrow unavailable"><a>&laquo;</a></li>
        {% endif %}


        <li class="current"><a>{{ page.number }}</a></li>


        {% if page.has_next %}
          <li>
            <a href="?page_number={{ page.next_page_number }}&{{ query_string }}">{{ page.next_page_number }}</a>
          </li>
          <li class="arrow">
            <a href="?page_number={{ page.next_page_number }}&{{ query_string }}">&raquo;</a>
          </li>
        {% else %}
          <li class="arrow unavailable"><a>&raquo;</a></li>
        {% endif %}

        <li>
          <a href="?page_number={{ paginator.page_range|last }}&{{ query_string }}">Last</a>
        </li>

      </ul>

      {{ report.title }}

    </caption>

    {% if report.table.header.cells %}
      <thead>
        <tr>
          {% for cell in report.table.header.cells %}
            <th>
              {% if cell.uri and add_sort_links %}
                <a class="navbar" href="{{ cell.uri }}"
                   title="{{ cell.explanation }}">{{ cell.text }}</a>
              {% else %}
                <span class="navbar" title="{{ cell.explanation }}">{{ cell.text }}</span>
              {% endif %}
            </th>
          {% endfor %}
        </tr>
      </thead>
    {% endif %}

    <tfoot>
      {% if report.table.footer.cells %}
        <tr class="tablesum">
          {% for cell in report.table.footer.cells %}
            <th>{{ cell.sum }}</th>
          {% endfor %}
        </tr>
      {% endif %}

      <tr>
        <th colspan="{{ report.table.header.cells|length }}">
          <span>{{ paginator.object_list|length }} total rows</span>
        </th>
      </tr>
    </tfoot>

    <tbody>
      {% if page %}

        {% for row in page %}
          <tr>

            {% for cell in row.cells %}
              <td>

                {% if cell.uri %}
                  <a href="{{ cell.uri }}">{{ cell.text|default:"" }}</a>
                {% else %}
                  {{ cell.text|deep_urlize|default:""|safe }}
                {% endif %}

              </td>
            {% endfor %}

          </tr>
        {% endfor %}

      {% else %}
        <tr>
          <td>&nbsp;</td>
        </tr>
      {% endif %}
    </tbody>
  </table>

</div>
