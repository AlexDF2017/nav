{% extends "base.html" %}

{% block base_header_additional_head %}
    <link rel="stylesheet" href="/style/index.css" />
    <link rel="stylesheet" href="/style/navlets.css" />
    <script>require(["src/webfront"]);</script>
{% endblock %}


{% block base_content %}

    <div class="large-9 columns">

        <div class="welcome">
            {{ welcome|safe }}
        </div>

{% comment %}
        <div class="mapwrapper">
            <div id="room_map" class="smallmap"></div>
        </div>
{% endcomment %}

        <div id="webfrontmain">

            <div id="navlets" data-list-navlets="{% url get-user-navlets %}" data-remove-navlet="{% url remove-user-navlet %}"></div>
            <a href="#" data-reveal-id="navlet-list" class="button">Add new Navlet</a>
            <div id="navlet-list" class="reveal-modal">
                <h4>Add a navlet to your page</h4>
                <table class="expand">
                    <tbody>
                    {% for navlet in navlets %}
                        <tr>
                            <td>{{ navlet.title }}</td>
                            <td>{{ navlet.description }}</td>
                            <td>
                                <form action="{% url add-user-navlet %}" method="post">
                                    <input type="hidden" name="navlet" value="{{ navlet.identifier }}">
                                    <input type="submit" class="button tiny" value="Add">
                                </form>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>

            </div>

{% comment %}
            {% endcomment %}
{% comment %} MESSAGES {% endcomment %}{% comment %}

            {% if current_messages %}
                <table class="listtable expand">
                    <caption>
                        <a href="{% url messages-active %}">Messages</a>
                        &ndash;
                        <span class="subtitle">
                            {{ current_messages|length }} active
                            message{{ current_messages|pluralize }}
                        </span>
                    </caption>

                    <thead>
                        <tr>
                            <th>Published</th>
                            <th>Title</th>
                            <th>Description</th>
                            <th>Tasks</th>
                        </tr>
                    </thead>

                    <tbody>
                        {% for m in current_messages %}
                        <tr>
                            <td>{{ m.publish_start }}</td>
                            <td><a href="{% url messages-view m.id %}">{{ m.title }}</a> </td>
                            <td>{{ m.description }}</td>
                            <td>
                                <img src="/images/status/wrench.gif" alt="Tasks" />
                                {{ m.maintenance_tasks.all|length }}
                            </td>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}

            {% endcomment %}
{% comment %} STATUS NOW {% endcomment %}{% comment %}

            {% if boxes_down %}
                <table class="listtable expand table-hover">

                <caption>
                    <a href="{% url status-index %}">Status now</a>
                    &ndash;
                    <span class="subtitle">
                        {{ boxes_down|length }} IP device{{ boxes_down|pluralize }} down,
                        {{ num_shadow }} in shadow
                    </span>
                </caption>

                <thead>
                    <tr>
                        <th>Sysname</th>
                        <th>IP</th>
                        <th>Down since</th>
                        <th>Downtime</th>
                    </tr>
                </thead>

                    <tbody>
                        {% for b in boxes_down %}
                        <tr>
                            <td><a href="{% url ipdevinfo-details-by-name b.netbox.sysname %}">
                                {{ b.netbox.sysname }}</a></td>
                            <td>{{ b.netbox.ip }}</td>
                            <td>{{ b.start_time|date:"DATETIME_FORMAT" }}</td>
                            <td>{{ b.start_time|timesince:date_now }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
{% endcomment %}

        </div>

    </div>


    {% comment %} Right side {% endcomment %}
    <div class="large-3 columns">
        <table class="expand">
            <tr>
                <th>NAV Links</th>
            </tr>
            <tr>
                <td>
                    {% for title,link in nav_links.items %}
                        <a href="{{ link }}">{{ title }}</a><br />
                    {% endfor %}
                </td>
            </tr>
        </table>

        <table class="expand">
            <tr>
                <th>External links</th>
            </tr>
            <tr>
                <td>{{ external_links|safe }}</td>
            </tr>
        </table>

        <table class="expand">
            <tr>
                <th>Contact information</th>
            </tr>
            <tr>
                <td>{{ contact_information|safe }}</td>
            </tr>
        </table>

    </div>
{% endblock %}
