{% load info %}

<div id="netboxes">

    <div id="global-search" class="ui-helper-hidden input-filter">
        Global search: <input id="netbox-global-search" type="text" />
    </div>

    <div class="input-filter">
        Last seen <input id="last-seen" type="text" size="3" /> days ago
    </div>

    <div class="float-clear"></div>

    {% for netbox in netboxes %}

        <table class="vertitable netbox compact cluttered">

            <caption><a href="{% url ipdevinfo-details-by-name netbox.sysname %}">{{ netbox.sysname }}</a> {% if netbox.type.name %} - {{ netbox.type.name }} {% endif %}</caption>

            <thead>
            <tr>
                <th>Name</th>
                <th>Portname</th>
                <th>Status</th>
                <th>Vlan</th>
                <th>Last active</th>
            </tr>
            </thead>

            <tbody>
            {% for interface in netbox.interfaces %}
                <tr>
                    <td>{{ interface.ifname }}</td>
                    <td>{{ interface.ifalias }}</td>
                    <td class="center-content">
                        <img title="Link status (green=link, red=no link)" src="/images/lys/{% if interface.ifoperstatus == interface.OPER_UP  %}green.png{% else %}red.png{% endif %}" alt="{% if interface.ifoperstatus == interface.OPER_UP  %}Up{% else %}Down{% endif %}"/>
                    </td>
                    <td class="numeric">
                        {% if interface.trunk %}<span class="pointer" title="Allowed vlans: {{ interface.get_trunkvlans_as_range }}">Trunk</span>{% else %}
                            {% if interface.vlan %}{{ interface.vlan }}{% endif %}
                        {% endif %}
                    </td>
                    <td {% if not interface.last_cam|is_max_timestamp %}
                            title="{{ interface.last_cam|date:"Y-m-d H:i" }}"
                        {% endif %}
                            class="numeric {% if interface.last_cam|is_max_timestamp %}brighten{% endif %}">

                        {% if not interface.trunk %}
                            {{ interface.last_cam|days_since }}
                            <span class="ui-helper-hidden" title="{% firstof interface.last_cam 'Never' %}"></span>
                        {% endif %}

                    </td>
                </tr>
            {% endfor %}
            </tbody>

        </table>

    {% endfor %}

</div>
