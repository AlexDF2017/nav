{% extends "info/room/base.html" %}

{% block base_header_additional_head %}
    <link href="/style/info_room.css" type="text/css" rel="stylesheet">
    <link href="/style/info_room_upload.css" type="text/css" rel="stylesheet">
    <script>require(["src/info_room_upload"]);</script>
{% endblock %}

{% block base_content %}

    <h2>Images in {{ room.id }}</h2>

    {% if room.image_set.all.count >= 2 %}
        <div id="orderbuttons">
            <button class="activate">Order images</button>
            <button class="save hidden">Save order</button>
        </div>
    {% endif %}

    <table id="editimages" class="listtable middle highlightover">
        <thead>
            <th>Image</th>
            <th>Image title</th>
            <th>Actions</th>
            <th>Uploadinfo</th>
        </thead>
        <tbody>
            <tr class="formcontainer">
                {% comment %} Note from the future: This is really ugly {% endcomment %}
                <form action="{% url room-info-upload room.id %}" method="POST" enctype="multipart/form-data">
                <td>{{ uploadform.roomimage }}{{ uploadform.roomimage.errors }}</td>
                <td>{{ uploadform.title }}{{ uploadform.title.errors }}</td>
                <td><input type="submit" value="Upload image"></td>
                <td>&nbsp;</td>
                </form>
            </tr>
            {% for image in room.image_set.all %}
            <tr data-imageid='{{ image.id }}' class="imagerow">
                <td class="thumbnail"><img src="/uploads/images/rooms/{{ image.path }}/{{ image.name }}"></td>
                <td class="imagetitle">{{ image.title|safe }}</td>
                <td class="actions">
                    <button class="edit">Edit title</button>
                    <button class="save hidden">Save title</button>
                    <button class="delete">Delete image</button>
                </td>
                <td class="meta">Uploaded {{ image.created|date:"DATETIME_FORMAT" }}<br/>by {{ image.uploader.name }}</td>

            </tr>
        {% endfor %}
        </tbody>
    </table>


{% endblock %}
