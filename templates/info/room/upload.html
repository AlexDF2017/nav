{% extends "info/room/base.html" %}

{% block base_header_additional_head %}
    <link href="/style/info_room.css" type="text/css" rel="stylesheet">
    <link href="/style/info_room_upload.css" type="text/css" rel="stylesheet">
    <script>require(["src/info_room_upload"]);</script>
{% endblock %}

{% block base_content %}

    <h2>Images in {{ room.id }}</h2>

    <ul class="infobox">
        <li>Add an image by clicking the file dialog, locating the image you want and clicking "Upload image"</li>
        <li>Captions may contain html - you can for instance create links</li>
        <li>Sort the images by dragging the arrows (if more than 1 image)</li>
    </ul>

    <table id="editimages" class="listtable middle highlightover">
        <thead>
            <th>Image</th>
            <th>Image caption</th>
            <th>Actions</th>
            <th>Uploader</th>
            <th>Date</th>
            <th>&nbsp;</th>
        </thead>
        <tbody>
            <tr class="formcontainer">
                {% comment %} Note from the future: This is really ugly {% endcomment %}
                <form action="{% url room-info-upload room.id %}" method="POST" enctype="multipart/form-data">
                <td>{{ uploadform.roomimage }}{{ uploadform.roomimage.errors }}</td>
                <td>{{ uploadform.title }}{{ uploadform.title.errors }}</td>
                <td><input type="submit" value="Upload image"></td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
                </form>
            </tr>
            {% for image in room.image_set.all %}
            <tr data-imageid='{{ image.id }}' class="imagerow">
                <td class="thumbnail"><img src="/uploads/images/rooms/{{ image.path }}/thumbs/{{ image.name }}"></td>
                <td class="imagetitle">{{ image.title|safe }}</td>
                <td class="actions">
                    <button class="edit">Edit caption</button>
                    <button class="save hidden">Save caption</button>
                    <button class="delete">Delete image</button>
                </td>
                <td class="meta">{{ image.uploader.name }}</td>
                <td class="meta">{{ image.created|date:"DATETIME_FORMAT" }}</td>
                <td class="drag">
                        <img src="/images/icons/go-up.png">
                        <img src="/images/icons/go-down.png">
                </td>

            </tr>
        {% endfor %}
        </tbody>
    </table>


{% endblock %}
