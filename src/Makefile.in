##
## Attempted Makefile for Java subsystems
## 
SHELL = @SHELL@
prefix = @prefix@
exec_prefix = @exec_prefix@
sysconfdir = @sysconfdir@
initdir = @initdir@
bindir = @bindir@
libdir = @libdir@
javalibdir = @javalibdir@
localstatedir = @localstatedir@
webroot = @webroot@
tooldir = @tooldir@

top_srcdir = @top_srcdir@

#BUILDARGS = -Dtop_srcdir=$(top_srcdir)/.. -Dprefix=$(prefix) -Dbindir=$(bindir) -Djavalibdir=$(javalibdir) -Dsysconfdir=$(sysconfdir) -Dlocalstatedir=$(localstatedir) -Dtooldir=$(tooldir) -Dwebroot=$(webroot)
#INSTALLARGS = -Dtop_srcdir=$(top_srcdir)/.. -Dprefix=$(DESTDIR)$(prefix) -Dbindir=$(DESTDIR)$(bindir) -Djavalibdir=$(DESTDIR)$(javalibdir) -Dsysconfdir=$(DESTDIR)$(sysconfdir) -Dlocalstatedir=$(DESTDIR)$(localstatedir) -Dtooldir=$(DESTDIR)$(tooldir) -Dwebroot=$(DESTDIR)$(webroot)
INSTALLARGS = -DDESTDIR=$(DESTDIR)

subdirs = \
	Util \
	ConfigParser \
	Database \
	Event \
	eventEngine \
	getBoksMacs \
	getDeviceData \
	Logger \
	NetboxInfo \
	SimpleSnmp \
	webapps/navAdmin

ANT = @ANT@

# Make sure we export make variables to the environment
export
.PHONY = all install clean distclean

all: $(subdirs)

$(subdirs): .
	@echo "Building $@ ..."
	(cd $@ && $(ANT) $(BUILDARGS)) && touch $@

.:
	touch .

install:
	@for dir in $(subdirs); do \
	  echo "Installing $$dir ..."; \
	  (cd $$dir && $(ANT) install $(INSTALLARGS)) || exit 1; \
	done

clean:
	rm -f *~ .lastbuild
	@for dir in $(subdirs); do \
	  echo "Entering $$dir ..."; \
	  (cd $$dir && $(ANT) $@) || exit 1; \
	done

distclean:
	@echo Target distclean is not supported in the java projects, but should be...
	rm -f build.properties
